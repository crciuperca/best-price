# best-price

# Start db
docker pull crciuperca/oracle-12c
docker run -d -p 8080:8080 -p 1521:1521 crciuperca/oracle-12c
# if you want to reuse previous data
docker run -d -p 8080:8080 -p 1521:1521 -v /my/oracle/data:/u01/app/oracle crciuperca/oracle-12c

# hostname: localhost
# port: 1521
# sid: xe
# service name: xe
# username: system
# password: oracle

# Create DB user
CREATE USER bestpriceuser IDENTIFIED BY bestpricepwd;
GRANT CONNECT, RESOURCE, DBA TO bestpriceuser;
GRANT ALL PRIVILEGES TO bestpriceuser;
GRANT UNLIMITED TABLESPACE TO bestpriceuser;

# Set up DB
CREATE TABLE ITEM_CATEGORY (
id                      NUMBER GENERATED BY DEFAULT ON NULL AS IDENTITY,
name                    VARCHAR2(999) NOT NULL,
parent_category_id      NUMBER,
PRIMARY KEY(id),
FOREIGN KEY(parent_category) REFERENCES ITEM_CATEGORY(id)
);

CREATE TABLE ITEM (
id              NUMBER GENERATED BY DEFAULT ON NULL AS IDENTITY,
name            VARCHAR2(999) NOT NULL,
url             VARCHAR2(999) NOT NULL,
category_id     NUMBER NOT NULL,
created_at      DATE DEFAULT SYSDATE,
PRIMARY KEY(id),
FOREIGN KEY(category_id) REFERENCES ITEM_CATEGORY(id)
);

CREATE TABLE ITEM_PRICE_HISTORY (
id              NUMBER GENERATED BY DEFAULT ON NULL AS IDENTITY,
price           NUMBER(10,2) NOT NULL,
created_at      DATE DEFAULT SYSDATE,
item_id         NUMBER NOT NULL,
PRIMARY KEY(id),
FOREIGN KEY(item_id) REFERENCES ITEM(id)
);